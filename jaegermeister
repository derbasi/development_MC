<script type="javascript" runat="server">
Platform.Load("Core",1)

var dataRows = "";
var dataExtension = "shopifyOrders2Permissions";
var targetDE = "shopifyLog"

dataRows = Platform.Function.LookupOrderedRows(dataExtension,10000,'CreatedDate ASC','processed','false', 'Id', 'a0j5q000000tJcZAAU');

if (dataRows.length > 0) {
 for (var x = 0; x < dataRows.length; x++) {
  var item = dataRows[x];
  var info = Platform.Function.ParseJSON(item.HIC_ShopifySync__Info__c);
  if (info.length > 0) {
   for (y = 0; y < info.length; y++) {
    var item1 = info[y];
    var id = Platform.Function.ParseJSON(item1.id);
    var email = Platform.Function.ParseJSON(item1.email);
    var acceptsMarketing = Platform.Function.ParseJSON(item1.accepts_marketing);
    var lastOrderId = Platform.Function.ParseJSON(item1.last_order_id);
    var confirmDate = Platform.Function.ParseJSON(item1.accepts_marketing_updated_at);
    //var rows = Platform.Function.UpsertData(targetDE,["Id"],["Id","email","acceptsMarketing","lastOrderId","confirmDate"],[id,email,acceptsMarketing,lastOrderId,confirmDate]);
    Write(Stringify("id: " + id + ", email: " + email + ", acceptsMarketing: " + acceptsMarketing + ", lastOrderId: " + lastOrderId));
    //Write("<br>")
    //var logDE = "shopifyPersonId";
    //var log = dataExtension.Init(logDE);
    //log.Rows.Add({id:"InsertData(Data Extension name,Column name,Value to insert)"})
    var rows = Platform.Function.InsertData(targetDE,["Id","email","acceptsMarketing","lastOrderId","confirmDate"],[id,email,acceptsMarketing,lastOrderId,confirmDate])
   }
  }

 }
}

</script>