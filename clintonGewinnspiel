<script runat="server" type="text/javascript">
Platform.Load("Core","1.1")

/* define marketingAction for process */
var marketingAction = 'MA00000001';

/* define couponsConfig DE */
var couponConfigDE = "couponsApiConfig";

/* get coupon information from couponConfigDE */
/* define journeyDE */
var journeyDE = Platform.Function.Lookup(couponConfigDE,'dataExtension','marketingAction',marketingAction);

/* get required fields */
var vouchername = Platform.Function.Lookup(couponConfigDE,'vouchername','marketingAction',marketingAction);
var validdays = Platform.Function.Lookup(couponConfigDE,'validDays','marketingAction',marketingAction);
var discount = Platform.Function.Lookup(couponConfigDE,'discount','marketingAction',marketingAction);
var type = Platform.Function.Lookup(couponConfigDE,'type','marketingAction',marketingAction);

/* get optional fields */
var code = Platform.Function.Lookup(couponConfigDE,'code','marketingAction',marketingAction);
if (code === null) { 
  var code = null
};

var minTotal = Platform.Function.Lookup(couponConfigDE,'minTotal','marketingAction',marketingAction);
if (minTotal === null) { 
  var minTotal = null
}; 

try{
/* get user count from journey DE */
var journeyDeRows = Platform.Function.LookupRows(journeyDE,'include','true');
var journeyDeRowsCount = journeyDeRows.length;
Write("journeyDeRowsCount: " + journeyDeRowsCount)
} catch(e) {
Write("error: " + e)
}


</script>